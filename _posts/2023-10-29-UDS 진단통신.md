---
layout : post
title : UDS 진단통신
comments : true
categories : 
- Embedded Engineering
tags : [Embedded Engineering]
---

# UDS 진단통신

- UDS(Unified Diagnostic Service) 프로토콜
- 차량 제조사들이 필요한 다양한 기능들을 정의 해둠
- ISO14229 기반
- OBD(On-board Diagnostics) 프로토콜 법적 의무 사항. 주로 차량 배기가스와 연관된 정보
- XCP(Universal measurement and Calibration Protocol) 프로토콜
주로 변수값 읽고,쓰는데 초점


## DTC : Diagnostic Trouble Code (고장 진단 코드)

- 고장이 발생 했을 때 어떤 고장인지를 구별해주는 Code
- Code를 나타내는 Format을 정의하는 다양한 국제 표준이 있음
- 널리 쓰이는 것 중 하나가 ISO 15031-6 에서 정의하는 Format


### DTC Status Mask
- bit 0 testFailed
- bit 1 testFailedThisOperationCycle
=> operation cycle 내 에러가 발생했는지에 대한 비트 Operation cycle 끝나면 clear
- bit 2 pendingDTC
=> operation cycle 내 에러가 발생했는지에 대한 비트 Operation cycle 끝나도 clear 되지 않는다
- bit 3 confirmedDTC
=> 제조사에서 정의, NVM 에 저장되는 DTC, UDS 진단을 통해 읽어올 수 있음
- bit 4 testNotCompletedSinceLastClear
=> clear 서비스 이후 test가 complete 되지 않았을 때 set
- bit 5 testFailedSinceLastClear
=> clear 서비스 이후 test가 fail 이 발생하면 set
- bit 6 testNotCompletedThisOperationCycle
=> 이번 operation cycle에서 test가 한 번도 끝나지 않았을 때 set
- bit 7 warningIndicatorRequested
=> 제조사에서 정의, 어떤 특정한 고장이 set


### Snapshot Data


- 고장 발생할 당시의 여러가지 데이터들을 기록해둔 것
- 스냅샷 데이터에 포함되는 데이터항목들은 모두 DID를 갖는
데이터들이다. 

#### 제조사에서 정의하는 속성들
- DTC 마다 Snap Shot Data 형태를 다르게 구성 가능
- SnapShot Data를 언제 저장할 것인지
- DTC마다 스냅샷 최대 몇개 찍을 수 있는지
- 스냅샷 저장된 갯수가 최대치에 도달한 경우 처리 규칙
