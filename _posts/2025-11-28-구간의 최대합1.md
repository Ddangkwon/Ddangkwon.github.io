---
layout : post
title : 구간의 최대합1
comments : true
categories : 
- CodingTest
tags : [CodingTest, Sqrt Decomposition]
---

# 구간의 최대합1


## 문제


N개의 정수로 이뤄진 수열을 입력 받는다.

(1 ≤ N ≤ 50000)

다음 Q개의 질의에 대한 답을 구하여 출력한다.

(1 ≤ Q ≤ 200000)

각 질의는 수열의 임의의 연속된 구간의 최대값을 구하여 답하는 것이다.




## 입력
입력의 첫번째 줄에는 수열을 이루는 원소의 갯수 N(1≤N≤50,000)과 

구간의 갯수 Q(1≤Q≤200,000)가 공백을 사이에 두고 입력된다. 

그 다음 N개의 줄에는 순서대로 서있는 원소의 숫자가 한줄에 하나씩 입력되는데, 

이는 1이상 1,000,000이하이다. 

그 다음 Q개의 구간의 시작 인덱스와 끝 인덱스 A, B가 공백을 사이에 두고 입력되며, 

A는 구간이 시작되는 원소의 번호, B는 구간이 끝나는 원소의 번호이며 

A와 B는 1이상 N이하의 수이며 A는 B보다 작거나 같다.




## 출력
입력된 Q개의 구간에 대한 가장 큰 원소를 출력하는 프로그램을 작성한다.




## 풀이

```cpp
#include <iostream>
#include <cmath>
#include <algorithm>

#define ARR_MAX_LEN 50001

using namespace std;

long long arr[ARR_MAX_LEN] = { 0 };
long long blockmax[ARR_MAX_LEN] = { 0 };
int N, Q, block_len;


void build_table(long long* arr) {

    long long max_num = 0;
    int cnt = 0;

    block_len = sqrt(N);

    if (block_len == 0)
        block_len = 1;

    for (int i = 0; i < N; i++) {
        if (cnt == block_len) {
            cnt = 0;
            max_num = 0;
        }

        max_num = max(max_num, arr[i]);

        blockmax[i / block_len] = max_num;
        cnt++;
    }


}

long long max_query(int start, int end, long long* arr) {
    long long res = 0;
    int start_block = start / block_len;
    int end_block = end / block_len;

    // 같은 블록 안에 다 들어있을 때
    if (start_block == end_block) {
        for (int i = start; i <= end; i++) {
            res = max(res, arr[i]);
        }
        return res;
    }

    // 시작 블록의 나머지 부분
    int end_of_start = (start_block + 1) * block_len;
    for (int i = start; i <= end_of_start; i++) {
        res = max(res, arr[i]);
    }

    // 중간에 완전히 포함된 블록들
    for (int i = start_block + 1; i < end_block; i++) {
        res = max(res, blockmax[i]);
    }

    // 마지막 블록의 일부
    int start_of_end = end_block * block_len;
    for (int i = start_of_end; i <= end; i++) { 
        res = max(res, arr[i]);
    }

    return res;
}

int main(void) {

    ios::sync_with_stdio(false);
    cin.tie(NULL);
    cout.tie(NULL);

    cin >> N >> Q;

    for (int i = 1; i <= N; i++) {
        cin >> arr[i];
    }

    build_table(arr);

    for (int i = 0; i < Q; i++) {
        int a, b;
        cin >> a >> b;

        long long answer = max_query(a, b, arr);
        cout << answer << "\n";
    }

    return 0;
}

```