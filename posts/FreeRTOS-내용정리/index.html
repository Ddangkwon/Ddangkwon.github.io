<!DOCTYPE html><html lang="ko-KR" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="FreeRTOS 내용정리" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="FreeRTOS 내용정리" /><meta property="og:description" content="FreeRTOS 내용정리" /><link rel="canonical" href="/posts/FreeRTOS-%EB%82%B4%EC%9A%A9%EC%A0%95%EB%A6%AC/" /><meta property="og:url" content="/posts/FreeRTOS-%EB%82%B4%EC%9A%A9%EC%A0%95%EB%A6%AC/" /><meta property="og:site_name" content="DK’s Software Engineering Knowledge Storage" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-12-20T00:00:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="FreeRTOS 내용정리" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="k9n3TqutGkNvqf7uv9HP04BF1yRBxsowePxu32o6gBk" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-08-05T00:17:41+09:00","datePublished":"2022-12-20T00:00:00+09:00","description":"FreeRTOS 내용정리","headline":"FreeRTOS 내용정리","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/FreeRTOS-%EB%82%B4%EC%9A%A9%EC%A0%95%EB%A6%AC/"},"url":"/posts/FreeRTOS-%EB%82%B4%EC%9A%A9%EC%A0%95%EB%A6%AC/"}</script><title>FreeRTOS 내용정리 | DK's Software Engineering Knowledge Storage</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="DK's Software Engineering Knowledge Storage"><meta name="application-name" content="DK's Software Engineering Knowledge Storage"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/green_galaxy.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">DK's Software Engineering Knowledge Storage</a></div><div class="site-subtitle font-italic">Software Engineering Knowledge Repo.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>홈</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>카테고리</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>태그</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>아카이브</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>정보</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['',''].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> 홈 </a> </span> <span>FreeRTOS 내용정리</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> 포스트</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="검색..."> </span> <span id="search-cancel" >취소</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>FreeRTOS 내용정리</h1><div class="post-meta text-muted"> <span> 게시 <em class="" data-ts="1671462000" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2022-12-20 </em> </span> <span> 업데이트 <em class="" data-ts="1691162261" data-df="YYYY-MM-DD" data-toggle="tooltip" data-placement="bottom"> 2023-08-05 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">DK</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="3710 단어"> <em>20 분</em>읽는 시간</span></div></div></div><div class="post-content"> <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9717042333563257" crossorigin="anonymous"></script><h1 id="freertos-내용정리">FreeRTOS 내용정리</h1><h2 id="task"><span class="mr-2">Task</span><a href="#task" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>태스크는 가상의 CPU를 각자 가지고 있는 것처럼 동작한다.(Time Division)<li>태스크 간에는 커널 서비스인 Inter Process Communication 방법을 사용하여 통신한다.</ul><h2 id="round-robin-스케쥴링"><span class="mr-2">Round Robin 스케쥴링</span><a href="#round-robin-스케쥴링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>모든 태스크들이 CPU 자원을 공평하게 나누어 사용하는 개념<li>각 태스크가 점유하는 시간을 타임 퀀텀이라고 하고 그 시간은 대락 1ms~20ms 사이이다.<li>비 선점형 스케쥴링을 필요로 할 때 사용한다.</ul><h2 id="priority-스케쥴링"><span class="mr-2">Priority 스케쥴링</span><a href="#priority-스케쥴링" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>태스크를 중요도에 의해 가중치를 두어 우선적으로 실행 할 수 있도록 하는 개념<li>RTOS 에서 피룻적으로 지원하는 스케쥴링 방법<li>선점형 스케쥴링의 특성을 가짐</ul><h2 id="blocking-io-non-blocking-io"><span class="mr-2">Blocking I/O, Non blocking I/O</span><a href="#blocking-io-non-blocking-io" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Blocking I/O</p><ul><li>태스크가 시스템콜을 호출했어도 점유한 데이터가 즉시 가용되지 않더라도 그 동작이 완료될 때 까지 suspending 상태를 유지한 것을 말함.</ul><p>Non blocking I/O</p><ul><li>태스크가 시스템콜을 호출했어도 점유한 데이터가 즉시 가용되지 않을 땐 리턴하는 것이 특징<li>Blocking 과는 다르게 프로세스가 쉬고있지 않음.</ul><h2 id="rtos-정의-및-특징"><span class="mr-2">RTOS 정의 및 특징</span><a href="#rtos-정의-및-특징" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>RTOS 는 임베디드 시스템 전용 운영체제이자 실시간 멀티태스킹 지원을 위한 운영체제이다.</p><p>RTOS 특징은 크게 다음과 같다.</p><ul><li>Hard Realtime<li>Scalability<li>Preemptive(선점형)<li>Multitasking<li>Deterministic(예측가능)<li>Portability<li>Robustness</ul><h2 id="real-time-시스템"><span class="mr-2">Real-Time 시스템</span><a href="#real-time-시스템" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>정해진 시간 내에 임무를 수행하는 시스템</p><p>Soft RealTime System</p><ul><li>가능한 빠르게 임무를 수행하는게 목표이고, 정해진 시간 내에 수행할 필요는 없음(Timeout 발생해도 계속 실행) Hard RealTime System<li>어떤 사건이 발생했을 때 정확하게 동작하는 것은 물론이고, 정해진 시간 내에 수행해야함(Timeout 발생 시 fail)</ul><h2 id="rtos-종류"><span class="mr-2">RTOS 종류</span><a href="#rtos-종류" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>FreeRTOS, Green Hills, VxWorks, Window Embedded, Texas Instruments</p><h2 id="freertos-특징"><span class="mr-2">FreeRTOS 특징</span><a href="#freertos-특징" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Portable(이식성 좋음)<li>ROMable(설정이나 응용프로그램에 따라 메모리의 크기를 바꿀 수 있음)<li>선점형 스케쥴링<li>Round-Robin 지원<li>Real-Time 기반으로 빠른 응답성을 가짐<li>Multitasking<li>MIT License</ul><h2 id="cmsis"><span class="mr-2">CMSIS</span><a href="#cmsis" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Cortex Microcontroller Software Interface Standard의 약자.</p><p>즉 다양한 칩 벤더가 Cortex 시리즈의 IP를 라이센스해가면서 하드웨어 독립적인 표준화된 소프트웨어 인터페이스가 필요하게 된다. 스펙은 ARM에 사용자 등록을 하면 받을 수 있다. CMSIS는 CMSIS-CORE, CMSIS-Driver, CMSIS-DSP, CMSIS-RTOS API, CMSIS-Pack, CMSIS-SVD, CMSIS-DAP 로 구성된다.</p><p>CMSIS 소프트웨어 인터페이스는 소프트웨어 재사용을 단순화하고 MCU 개발자의 학습 곡선을 줄여 개발 속도를 단축 시킨다. CMSIS 는 프로세서 및 주변 장치, 실시간 운영 체제 및 미들웨어 구성 요소에 대한 인터페이스를 제공한다. CMSIS 에는 장치, 보드 및 소프트웨어에 대한 전달 메카니즘이 포함되어 있고, 여러 타 사 업체의 소프트웨어 구성요소와 결합이 가능하다.</p><h2 id="포팅porting"><span class="mr-2">포팅(Porting)</span><a href="#포팅porting" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>이식(移植) 또는 포팅(porting)은 컴퓨터 과학에서 실행 가능한 프로그램이 원래 설계된 바와 다른 컴퓨팅 환경(이를테면 CPU, 운영 체제, 서드 파티 라이브러리 등)에서 동작할 수 있도록 하는 과정을 가리킨다. 이 용어는 소프트웨어나 하드웨어가 다른 환경에서 사용할 수 있게 변경되는 것에도 해당한다. 소스 하나로 여러 플랫폼에서 사용할 수 있는 것을 크로스 플랫폼으로 부른다.</p><h2 id="태스크-함수-구성-요소"><span class="mr-2">태스크 함수 구성 요소</span><a href="#태스크-함수-구성-요소" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>태스크 함수의 경우 태스크 함수, 함수의 이름, 스택 항목의 개수, 태스크 전달 파라미터, 우선순위, 핸들러 등으로 구성된다. 그리고 태스크 스택의 경우 heap 영역이나 .bss 영역에 저장된다.</p><p>그리고 태스크의 우선순위를 매길 때 보통 높은 숫자가 높은 우선순위를 나타내기 때문에,</p><p>낮은 우선순위에는 명확한 낮은 숫자를, 높은 우선 순위에는 명확히 높은 숫자를 사용하여 한 눈에 구분이 가게하는 것이 좋다.</p><p>그리고 Task의 경우</p><p>TaskMain()</p><ul><li>Task1()<li>Task2()<li>Task3()</ul><p>와 같은 함수를 가지고 있다.</p><h2 id="taskcreate-함수"><span class="mr-2">TaskCreate() 함수</span><a href="#taskcreate-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>태스크 객체를 만들어주는 함수로 태스크 스택 항목의 개수 우선순위, 전달 파라미터 등을 설정한다.</p><h2 id="taskdelete-함수"><span class="mr-2">TaskDelete() 함수</span><a href="#taskdelete-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>태스크 객체를 없애주는 역할을 하는 함수</p><h2 id="tasksuspend-함수"><span class="mr-2">TaskSuspend() 함수</span><a href="#tasksuspend-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>해당 태스크 핸들러를 매개변수로 받아 태스크를 blocked 상태로 진입하게 만든다.</p><h2 id="vtaskpriorityset-vtaskresume"><span class="mr-2">vTaskPrioritySet(), vTaskResume()</span><a href="#vtaskpriorityset-vtaskresume" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>각각 태스크 우선순위를 재설정하는 함수와, 그 태스크를 변경된 우선순위에 맞춰 다시 실행시키는 함수를 가리킨다.</p><h2 id="taskdelay-함수"><span class="mr-2">TaskDelay() 함수</span><a href="#taskdelay-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>1초 만큼 task가 잠시 blocked 상태에 가있다가 다시 ready=&gt;running 상태로 진입 잠시 blocked 상태로 이동하고 다른 태스크가 running 상태에 진입하기 때문에 문맥 전환(Context Switch) 가 발생한다. runnig task 가 아예 비어있는 것을 막기 위해 우선순위가 가장 낮은 idle task 를 만들고 비어있을 경우 idle task가 running 상태로 진입 TaskDelay 함수를 통해 각 태스크가 할당받을 시간을 정해 놓고 번갈아가며 task가 running 상태에 진입할 수 있도록하여 멀티태스킹을 구현한다.</p><h2 id="idletask-함수"><span class="mr-2">IdleTask() 함수</span><a href="#idletask-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>우선순위 0인 최하위 우선순위 함수 TaskStartScheduler() 함수에서 생성되고 삭제할 수 없다. CPU 저전력 모드 처럼 별다른 동작을 하지 않는 함수</p><h2 id="우선순위와-실행시간의-관계"><span class="mr-2">우선순위와 실행시간의 관계</span><a href="#우선순위와-실행시간의-관계" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>우선순위가 높다고 그 task가 자주, 오래 실행되는 것이 아니다. =&gt; 휴면을 적게 할수록 오래 실행한다.</p><p>즉 우선순위가 높고 그 task가 휴면을 적게 한다면 자주, 오래 실행할 것이다.</p><h2 id="printf-fflush-함수"><span class="mr-2">printf(), fflush() 함수</span><a href="#printf-fflush-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>printf() 함수의 경우 문자열 버퍼가 있고 그 버퍼가 꽉 채워져야 버퍼를 배출한다. fflush(stdout) 함수의 경우 문자열 버퍼를 배출하고 버퍼를 비운다. ==&gt; fflush(stdout) 의 경우 UART 를 통해 HW 동작을 야기하고 화면 상에 출력하기 때문에 동작이 상대적으로 느리다.</p><h2 id="attribute"><span class="mr-2"><strong>attribute</strong></span><a href="#attribute" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>우리가 함수를 선언할 때 부여하는 속서을 말한다. 이 <strong>attribute</strong> 다음에는 쌍괄호로 싸여진 속성인자가 따라온다.</p><p><strong>attribute</strong>((weak)) func(void); , void func(void) <strong>attribute</strong>((weak));</p><p>같이 weak 함수를 선언해서 컴파일 시 같은 이름의 심볼이 있을 경우 weak 속성의 심볼을 제거하고 weak가 아닌 것을 사용하는 것을 말한다.</p><p>__attribute__를 이용할 시에는 최대한 헤더파일에서 정의하지 않을 것을 추천</p><p>weak 심볼들의 경우 상황에 따라 꺼낼 수 있는 함수들의 default implementation 을 제공할 때 사용된다.</p><h2 id="태스크-스택-메모리task-stack-memory"><span class="mr-2">태스크 스택 메모리(task stack memory)</span><a href="#태스크-스택-메모리task-stack-memory" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>태스크 스택 메모리에는 정적, 동적 메모리 영역을 사용할 수 있다.</p><p>태스크 스택의 경우 태스크에서 호출하는 함수의 중복 호출 횟수, 함수에서 사용되는 모든 지역변수의 크기 등에 의해 결정된다. 이 중 동적메모리 사용은 메모리 단편화(Memory Fragmentation)을 야기할 수 있다.</p><h3 id="메모리-단편화memory-fragmentation"><span class="mr-2">메모리 단편화(Memory Fragmentation)</span><a href="#메모리-단편화memory-fragmentation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>기억 장치의 빈 공간이나 데이터가 여러 개로 쪼개지는 현상을 말한다. 이 이유로, 요청한 메모리의 크기가 가용한 메모리의 크기보다 작은데도 불구하고 메모리 할당에 실패할 수 있는 문제를 낳는다.</p><p>메모리 단편화를 피하기 위해서 가급적 큰 크기로 메모리를 할당하고, 부팅하자마자 main.c 극 초반에서 메모리를 할당하는 방법으로 메모리 단편화를 최소화한다.</p><h2 id="스택-오버플로우stack-overflow"><span class="mr-2">스택 오버플로우(Stack Overflow)</span><a href="#스택-오버플로우stack-overflow" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>FreeRTOS의 경우 Stack Overflow 검사를 위한 파라미터 옵션이 존재한다. =&gt; 이 옵션 역시 모든 것을 커버하지는 못함 ( 그 이유로는 문맥 전환(Context change) 중에 오버플로우를 검사하는 방식으로 이외 시간에 발생하는 스택 오버플로우는 찾지 못 한다.)</p><p>스택 오버플로우 검사의 경우 스택 메모리 마지막 영역 지점에 특정 패턴 값을 초기에 채워 놓고 그 값이 오염되어있는지 여부에 대해 확인하는 방법으로 검사를 수행한다. =&gt; 다소 느림 또는 스택 포인터가 유효한 범위를 벗어난 스택 공간 내에 있는 것이 실시간으로 확인될 경우 hook 함수를 호출하여 검출하는 방식도 있다. =&gt; 문맥 전환시에만 검사</p><h2 id="tcbtask-control-block"><span class="mr-2">TCB(Task Control Block)</span><a href="#tcbtask-control-block" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Task에 관련된 모든 정보가 저장되어있는 블록(구조체)</p><h2 id="동시성-문제concurrent-entrancy"><span class="mr-2">동시성 문제(Concurrent Entrancy)</span><a href="#동시성-문제concurrent-entrancy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ol><li>공유자원이 있다.(공유하는 변수나, 함수)<li>비원자적인 연산(읽기 =&gt; 수정 =&gt; 쓰기) 특정 함수나 변수를 서로 다른 태스크에서 동시에 호출될 때 의도치 않은 결과가 나타나는 문제</ol><p>이러한 임계 영역을 보호하기 위해 장치를 마련한다.</p><ul><li>인터럽트 중단<li>스케쥴링 중단<li>세마포어</ul><h2 id="임계-영역critical-section"><span class="mr-2">임계 영역(Critical Section)</span><a href="#임계-영역critical-section" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>공유자원이 사용 중인 함수 내 일부 혹은 전체 영역</p><h2 id="재진입reentrancy"><span class="mr-2">재진입(Reentrancy)</span><a href="#재진입reentrancy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>멀티태스킹 환경에서 함수들은 재진입이 가능하도록 가급적 HW 자원, 전역 변수 사용 등의 행위를 하지 않아야 한다. 멀티태스킹 환경이지만 단일 태스크만이 독점하여 사용할 것으로 확신하는 경우에는 해당 함수가 재진입이 아니어도 무방하다.</p><p>함수가 재진입 가능하도록 하는 조건(상호 배제 방법(Mutual Exclusion))</p><ul><li>전역 변수 사용 X<li>세마포어 같은(세마포어, 뮤텍스) 커널 리소스로 전역변수 보호<li>전역변수 사용 동안 인터럽트 작동 임시 중지</ul><h2 id="크리티컬-섹션critical-section"><span class="mr-2">크리티컬 섹션(Critical Section)</span><a href="#크리티컬-섹션critical-section" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>크리티컬 섹션에서는 임시적으로 인터럽트를 비활성화하여 보호한다. 이러한 인터럽트 비활성화 시간은 RTOS 시스템에서 이벤트의 응답시간을 결정하므로 중요한 성능 지표가 된다. 이 인터럽트 비활성화는 응용프로그램에서도 사용할 수 있으나 freeRTOS 서비스 호출 시에는 인터럽트는 꼭 활성화가 되어있어야한다.</p><h2 id="freertos-우선-순위"><span class="mr-2">FreeRTOS 우선 순위</span><a href="#freertos-우선-순위" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>taskENTER_CRITICAL =&gt; 일반 인터럽트(Tick, IRQ) =&gt; 높은 우선순위 =&gt; 낮은 우선순위(EX. IDLE Task)</p><h2 id="태스크-문맥전환context-switch"><span class="mr-2">태스크 문맥전환(Context Switch)</span><a href="#태스크-문맥전환context-switch" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>문맥(Context)는 모든 CPU의 레지스터를 말한다. 문맥 전환은 선점된 태스크의 모든 레지스터 값을 스택에 저장하고, 전에 저장했던 레지스터 값을 CPU로 복구하여 새로운 태스크를 실행하는 것을 말한다.</p><h2 id="코루틴coroutine"><span class="mr-2">코루틴(Coroutine)</span><a href="#코루틴coroutine" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>코루틴은 RAM 제약이 심한 프로세서에서만 사용하고 32비트 MCU의 경우 잘 사용하지 않는다.</p><p>우선순위가 IDLE TASK와 같이 가장 낮은 우선순위를 가진다.</p><p>특징은 스택메모리를 가지고 있지 않고 IDLE TASK의 스택 메모리를 공유한다. =&gt; 메모리 효율성 증대 대신 스택메모리를 공유하기 때문에 코루틴 내부 지역 변수 값이 의도치 않게 변경될 수 있음 =&gt; static으로 선언하여 .bss 영역에 잡히도록 수정</p><h2 id="시스템-성능-최적화-기법"><span class="mr-2">시스템 성능 최적화 기법</span><a href="#시스템-성능-최적화-기법" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>속도를 느리게만드는 전역 변수 선언량, 그리고 이를 사용하는 빈도 수를 태스크에서 줄인다.<li>시간 소요가 많은 인터럽트 루틴은 IPC를 활용하여 태스크에서 그 일을 수행하도록 한다.<li>빈번이 호출되는 함수는 인라인 어셈블리 등을 활용한다<li>TICK 시간이 지켜지는지 확인한다.</ul><h2 id="freertos에서의-우선순위-배정"><span class="mr-2">FreeRTOS에서의 우선순위 배정</span><a href="#freertos에서의-우선순위-배정" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>해당 태스크의 중요도에 따른 우선순위 배정이 아닌 일의 마감시간(or 응답시간)을 철저히 준수할 수 있도록 우선순위를 배정해야한다.<li>처음 그 기능(태스크)의 구현단계부터 마감시간을 염두해두고 설계를 진행해야한다.</ul><h2 id="세마포어semaphore"><span class="mr-2">세마포어(Semaphore)</span><a href="#세마포어semaphore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>임계구역을 보호하는 가장 안전한 방법 중 하나<li>세마포어는 P(잠금), V(잠금 해제), 초기화 이 세가지에 의해서만 접근이 가능한 일종의 protect 변수 개념</ul><p>세마포의 2가지 기능 1, 상호 배제(임계구역 보호)</p><ol><li>IPC(이벤트 전달)</ol><h3 id="free-rtos에서의-세마포어-함수"><span class="mr-2">FREE RTOS에서의 세마포어 함수</span><a href="#free-rtos에서의-세마포어-함수" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><ul><li>초기화 함수 : vSemaPhoreCreateBinary(), xSemaPhoreCreateBinary()<li>P연산 함수 : xSemaPhoreTake()<li>V연산 함수 : xSemaPhoreGive()</ul><h2 id="태스크-간-통신ipc"><span class="mr-2">태스크 간 통신(IPC)</span><a href="#태스크-간-통신ipc" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>전역변수를 사용한 통신 방법 =&gt; 임계 영역에 따른 의도치 않은 동작 발생 가능<li>메시지 전송 =&gt; 메시지 메일박스(이벤트 플래그, 세마포어), 큐</ul><h2 id="우선순위역전priority-inversion"><span class="mr-2">우선순위역전(Priority Inversion)</span><a href="#우선순위역전priority-inversion" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>높은 우선순위의 태스크가 낮은 우선순위 태스크가 끝날때까지 기다리는 현상</p><h2 id="뮤텍스mutex--mutual-exclusion-semaphore"><span class="mr-2">뮤텍스(MUTEX : Mutual Exclusion Semaphore)</span><a href="#뮤텍스mutex--mutual-exclusion-semaphore" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>태스크가 자원에 대한 독점적인 액세스를 얻고자 할 때 사용한다.<li>일종의 바이너리 세마포어이다.<li>우선순위 역전현상을 해결할 때 사용한다.</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/embedded-engineering-rtos/'>Embedded Engineering, RTOS</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/embedded-engineering/" class="post-tag no-text-decoration" >Embedded Engineering</a> <a href="/tags/rtos/" class="post-tag no-text-decoration" >RTOS</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> 이 기사는 저작권자의 <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> 라이센스를 따릅니다.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">공유하기</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=FreeRTOS+%EB%82%B4%EC%9A%A9%EC%A0%95%EB%A6%AC+-+DK%27s+Software+Engineering+Knowledge+Storage&url=%2Fposts%2FFreeRTOS-%25EB%2582%25B4%25EC%259A%25A9%25EC%25A0%2595%25EB%25A6%25AC%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=FreeRTOS+%EB%82%B4%EC%9A%A9%EC%A0%95%EB%A6%AC+-+DK%27s+Software+Engineering+Knowledge+Storage&u=%2Fposts%2FFreeRTOS-%25EB%2582%25B4%25EC%259A%25A9%25EC%25A0%2595%25EB%25A6%25AC%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FFreeRTOS-%25EB%2582%25B4%25EC%259A%25A9%25EC%25A0%2595%25EB%25A6%25AC%2F&text=FreeRTOS+%EB%82%B4%EC%9A%A9%EC%A0%95%EB%A6%AC+-+DK%27s+Software+Engineering+Knowledge+Storage" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="링크 복사하기" data-title-succeed="링크가 복사되었습니다!"> </i> </span></div></div></div><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">최근 업데이트</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/STL_MAP/">STL_Map</a><li><a href="/posts/STL_Priority_Queue/">STL_Priority_Queue</a><li><a href="/posts/STL_Vector/">STL_Vector</a><li><a href="/posts/STL_String/">STL_String</a><li><a href="/posts/STL_Queue/">STL_Queue</a></ul></div><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/codingtest/">CodingTest</a> <a class="post-tag" href="/tags/bfs/">BFS</a> <a class="post-tag" href="/tags/simulation/">simulation</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/dfs/">DFS</a> <a class="post-tag" href="/tags/embedded-engineering/">Embedded Engineering</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/stl/">STL</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">바로가기</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>관련된 글</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Embedded_OS-%EA%B0%9C%EB%B0%9C/"><div class="card-body"> <em class="small" data-ts="1663513200" data-df="YYYY-MM-DD" > 2022-09-19 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Embedded OS 개발</h3><div class="text-muted small"><p> Embedded OS 개발 프로젝트 1장. 임베디드 운영체제 임베디드 운영체제와 펌웨어 임베디드 운영체제는 임베디드 시스템에서 동작하는 펌웨어의 일종으로서 하드웨어 성능이 일정 수준으로 올라온 현재 임베디드 장치에도 임베디드 운영체제를 많이 사용하고 있다. 펌웨어란 임베디드 운영체제 유무에 상관없이 임베디드 시스템 용 전체 소프트웨어를 지칭한다...</p></div></div></a></div><div class="card"> <a href="/posts/%EC%95%84%EB%91%90%EC%9D%B4%EB%85%B8-%EC%97%90%EC%96%B4%EC%BB%A8-%EC%9E%90%EB%8F%99-%EC%A0%9C%EC%96%B4/"><div class="card-body"> <em class="small" data-ts="1747494000" data-df="YYYY-MM-DD" > 2025-05-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>아두이노 에어컨 자동 제어</h3><div class="text-muted small"><p> [아두이노] 에어컨 자동 제어 아두이노를 활용하여 에어컨의 리모컨 신호를 복사하고, 원하는 시간에 자동으로 송신하여 에어컨을 제어하는 프로젝트를 진행할 수 있다. 이를 위해 필요한 부품, 회로 연결 방법, 아두이노 코드 예제, 그리고 시간 기반 제어 방법을 자세히 설명한다. 1. 필요한 부품 아두이노 보드 (Arduino Uno, ATmeg...</p></div></div></a></div><div class="card"> <a href="/posts/CodeOptimization/"><div class="card-body"> <em class="small" data-ts="1654959600" data-df="YYYY-MM-DD" > 2022-06-12 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>코드 최적화(CodeOptimization)</h3><div class="text-muted small"><p> 코드 최적화 최적화의 등가교환(Trade-Off) 크기 vs 속도 성능 vs 가독성 임베디드 소프트웨어의 최적화 규칙 최선의 알고리즘, 최적의 코드를 찾아라 하드웨어 특성(프로세서), 개발 툴 등을 잘 이해하고 활용하라 헤더 인클루드 중복성 제거 #ifndef FUNC_H// 정의가 되어있지 않을 경우 인클루드(딱 한번만 인클루드 하게 됨)...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/%EC%8B%9C%EC%A0%80-%EC%95%94%ED%98%B8/" class="btn btn-outline-primary" prompt="이전 글"><p>시저 암호</p></a> <a href="/posts/%EC%86%8C%EC%88%98%EC%9D%98-%EA%B0%9C%EC%88%98(%EC%97%90%EB%9D%BC%ED%86%A0%EC%8A%A4%ED%85%8C%EB%84%A4%EC%8A%A4%EC%9D%98-%EC%B2%B4)/" class="btn btn-outline-primary" prompt="다음 글"><p>소수의 개수</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">DK</a>. <span data-toggle="tooltip" data-placement="top" title="명시되지 않는 한 이 사이트의 블로그 게시물은 작성자의 Creative Commons Attribution 4.0 International(CC BY 4.0) 라이선스에 따라 사용이 허가되었습니다.">일부 권리 보유</span></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">인기 태그</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/codingtest/">CodingTest</a> <a class="post-tag" href="/tags/bfs/">BFS</a> <a class="post-tag" href="/tags/simulation/">simulation</a> <a class="post-tag" href="/tags/dp/">DP</a> <a class="post-tag" href="/tags/dfs/">DFS</a> <a class="post-tag" href="/tags/embedded-engineering/">Embedded Engineering</a> <a class="post-tag" href="/tags/algorithm/">Algorithm</a> <a class="post-tag" href="/tags/stl/">STL</a> <a class="post-tag" href="/tags/container/">Container</a> <a class="post-tag" href="/tags/python/">python</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">새 버전의 콘텐츠를 사용할 수 있습니다.</p><button type="button" class="btn btn-primary" aria-label="Update"> 업데이트 </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">검색 결과가 없습니다.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/ko.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
